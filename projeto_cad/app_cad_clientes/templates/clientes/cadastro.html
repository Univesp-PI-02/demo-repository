{% extends 'clientes/base.html' %}
{% block conteudo %}
<!doctype html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>Bootstrap demo</title>
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
   </head>
   <body>
      <h1></h1>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
      <div class="alert alert-danger" role="alert">
         <b>ATENÇÃO:</b> É obrigatório o preenchimento de todos os campos, preencha os campos vazios com N/A.
      </div>
      <div class="alert alert-warning" role="alert">
         <b>OBS:</b> Não utilize caracteres especiais ao preencher logradouros, documentos (CEP, CNPJ e etc).
      </div>
      <div class="container my-5">
         <h1 class="text-center mb-4">Cadastrar Clientes</h1>
         <form action="{% url 'cadastro' %}" method="post" class="card p-4 shadow-sm">
            {% csrf_token %}
            <div class="row mb-3">
               <div class="col-md-6">
                  <label>Empresa</label>
                  <input name="empresa" class="form-control" type="text" required>
               </div>
               <div class="col-md-6">
                  <label>Status</label>
                  <select name="status" class="form-control" required>
                     <option value="Sondagem">Sondagem</option>
                     <option value="Apresentando">Apresentando</option>
                     <option value="Negociando">Negociando</option>
                     <option value="Cliente">Cliente</option>
                     <option value="Sem viabilidade">Sem Viabilidade</option>
                     <option value="Sem interesse">Sem Interesse</option>
                  </select>
               </div>
            </div>
            <div class="row mb-3">
               <div class="col-md-6">
                  <label>Segmento</label>
                  <input name="segmento" class="form-control" type="text">
               </div>
               <div class="col-md-6">
                  <label>Contato</label>
                  <input name="contato" class="form-control" type="text">
               </div>
            </div>
            <div class="row mb-3">
               <div class="col-md-6">
                  <label>Telefone</label>
                  <input name="telefone" class="form-control" type="text">
               </div>
               <div class="col-md-6">
                  <label>Telefone Secundário</label>
                  <input name="telefone_2" class="form-control" type="text">
               </div>
            </div>
            <div class="row mb-3">
               <div class="col-md-6">
                  <label>CEP</label>
                  <div class="d-flex">
                     <input id="cep" name="cep" class="form-control" type="text">
                     <button type="button" id="btn-pesquisar" class="btn btn-outline-secondary ms-2">Pesquisar</button>
                  </div>
               </div>
               <div class="col-md-6">
                  <label>Rua</label>
                  <input id="rua" name="rua" class="form-control" type="text">
               </div>
            </div>
            <div class="row mb-3">
               <div class="col-md-4">
                  <label>Número</label>
                  <input name="numero_end" class="form-control" type="text">
               </div>
               <div class="col-md-4">
                  <label>Bairro</label>
                  <input id="bairro" name="bairro" class="form-control" type="text">
               </div>
               <div class="col-md-4">
                  <label>Complemento</label>
                  <input name="complemento" class="form-control" type="text">
               </div>
            </div>
            <div class="row mb-3">
               <div class="col-md-6">
                  <label>Cidade</label>
                  <input id="cidade" name="cidade" class="form-control" type="text">
               </div>
               <div class="col-md-6">
                  <label>Estado</label>
                  <input id="estado" name="estado" class="form-control" type="text">
               </div>
            </div>
            <div class="row mb-3">
               <div class="col-md-6">
                  <label>Email</label>
                  <input name="email" class="form-control" type="email">
               </div>
               <div class="col-md-6">
                  <label>Instagram</label>
                  <input name="instagram" class="form-control" type="text">
               </div>
            </div>
            <div class="row mb-3">
               <div class="col-md-6">
                  <label>CNPJ</label>
                  <input name="cnpj" class="form-control" type="text">
               </div>
               <div class="col-md-6">
                  <label>Nº Lojas</label>
                  <input name="qtd_lojas" class="form-control" type="number">
               </div>
            </div>
            <div class="row mb-3">
               <div class="col-md-6">
                  <label>Primeiro Contato</label>
                  <input name="primeiro_contato" class="form-control" type="datetime-local">
               </div>
               <div class="col-md-6">
                  <label>Próximo Contato</label>
                  <input name="prox_contato" class="form-control" type="datetime-local">
               </div>
            </div>
            <div class="row mb-3">
               <div class="col-md-12">
                  <label>Observações</label>
                  <textarea name="observacoes" class="observacao-texto form-control" rows="2" placeholder="Digite uma nova observação..." required></textarea>
               </div>
            </div>
            <div class="text-center">
               <button type="submit" class="btn btn-success">Cadastrar Cliente</button>
            </div>
         </form>
      </div>
      <style>
         /* Estilo da Seção de Observações */
         .observacoes-container {
         margin-top: 10px;
         }
         .observacao-item {
         background-color: #f8f9fa;
         border: 1px solid #ddd;
         border-radius: 8px;
         padding: 8px;
         margin-bottom: 6px;
         box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
         }
         .observacao-conteudo {
         display: flex;
         align-items: center;
         justify-content: space-between;
         }
         .observacao-texto {
         border: none;
         background: none;
         resize: none;
         width: 100%;
         padding: 4px;
         font-size: 13px;
         color: #333;
         height: 1.0em;
         }
         .observacao-botoes {
         display: flex;
         gap: 8px;
         }
         .btn-salvar {
         font-size: 12px;
         padding: 5px 10px;
         color: #007bff;
         }
      </style>
      <script>
         document.getElementById('btn-pesquisar').addEventListener('click', function () {
           const cep = document.getElementById('cep').value.replace(/\D/g, '');
           if (cep.length !== 8) {
             alert('CEP inválido! Por favor, insira um CEP válido.');
             return;
           }
           fetch(`https://viacep.com.br/ws/${cep}/json/`)
             .then(response => response.json())
             .then(data => {
               if (data.erro) {
                 alert('CEP não encontrado!');
               } else {
                 document.getElementById('rua').value = data.logradouro;
                 document.getElementById('bairro').value = data.bairro;
                 document.getElementById('cidade').value = data.localidade;
                 document.getElementById('estado').value = data.uf;
               }
             })
             .catch(error => console.error('Erro:', error));
         });
      </script>
      {% endblock %}
   </body>
</html>